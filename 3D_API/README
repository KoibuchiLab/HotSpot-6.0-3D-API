//
// Totoki (totoki@am.ics.keio.ac.jp) 2017.8.22 (tiny update by koibuchi@nii.ac.jp)
// Augmented/Restructued by Henri (henric@hawaii.edu)
//

***************************************************
** Compiling/Running hotspot                     **
***************************************************

1. Compiling


sudo apt-get install superlu-dev libsuperlu4		# install the superlu package
cd HotSpot-6.0-3D-API					# go to the main hotspot directory
make SUPERLU=1						# build (enabling superlu)
cd 3D_API						# go to this directory
make							# build (the ./cell executable)


2. Generating an input file for target layout of 3-D chip stacking

File format (each line):
chipname, Z(vertical)-axis(Layer: 1,2,...), X-axis(m), Y-axis(m) (left/side of chip coordinate), Frequency(MHz), chip rotation(0,90,180,270 degree)
tulsa 1 0.00 0.00 1380 0  // corresponding to PTRACE/tulsa-1380.ptrace
HOGE/e5-2667v4 2 0.011 0.011 is3600 0 // PTRACE/HOGE/e5-2667v4-is3600.ptrace
e5-2667v4 1 0.001 0.031 cg2400 0
tulsa 1 0.03 0.03 185 0
phi7250 1 0.03 0.00 1300 0 //PTRACE/phi7250-1300.ptrace  (stress command)

## tulsa chip is modeled by McPAT-1.3
## phi7250, Xeon e5-2667v4 is physically measured/estimated by Intel RAPL

### Caution !!! Caution !!! ###
Xeon E5-2667v4 power model is not completed.
LLC(Last Level Cache) power is not included yet (will be introduced soon)
###############################

Each floorplan of processor chips is stored at ./FLOORPLAN/{e5-2667v4.flp,phi7250.flp,tulsa.flp}

A sample input file is provided in ./test.data


3. Running 

Usage: python hotspot.py  <input file (.data)> [water | air | oil ]

For instance, running

python ./hostspot.py test.data water --no_images

should print out something like: "maximum temp: 36.51"

Result files:
	./tmp.results -> a highest temperature of modules on all chips
	./figure/*.pdf -> Temperature distribution of all chips (unless the --no_images flag is specified)

- Note that temperature_grid.c is modified from the HotSpot-6.0 distribution

